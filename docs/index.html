<!DOCTYPE html>
<html lang="en">
    <head>
        <title>copy</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        <style>
            body {
                color: #ffffff;
                font-family:Monospace;
                font-size:13px;
                text-align:center;
                font-weight: bold;
                background-color: #000000;
                margin: 0px;
                overflow: hidden;
            }
            #info {
                position: absolute;
                top: 0px; width: 100%;
                padding: 5px;
            }
            a { color: #ffffff; }
        </style>
    </head>
<body>



        <div id="container"></div>
        <script id="fragment_shader_screex" type="x-shader/x-fragment">
            varying vec2 vUv;
            uniform sampler2D tDiffuse;
            uniform float width;
            uniform float height;

            vec4 neighbor(float dx, float dy) {
                float h = 1.0/500.0;
                vec2 coord = vUv + vec2(h*dx, h*dy);
                vec4 col = texture2D( tDiffuse, coord);
                return col;
            }

            void main() {
                float sum = 0;
                for(i = -1; i <= 1; i++){
                    for(j=-1; j <= 1; j++){
                        sum = sum + neighbor(i*1.0, j*1.0).x;
                    }
                }
                float self = texture2D( tDiffuse, vUv).x;
                sum = sum - self;
                float alive = 0.0;
                if(sum == 3) {
                    alive = 1.0;
                }
                if(sum == 2){
                    if(self > 0.5){
                        alive = 1.0;
                    }
                }
                gl_FragColor = vec4(alive, alive, alive, 1);
            }
        </script>

        <script id="fragment_shader_screen" type="x-shader/x-fragment">
            varying vec2 vUv;
            uniform sampler2D tDiffuse;
            uniform float width;
            uniform float height;

            vec4 neighbor(float dx, float dy) {
                float h = 1.0/500.0;
                vec2 coord = vUv + vec2(h*dx, h*dy);
                vec4 col = texture2D( tDiffuse, coord);
                return col;
            }

            void main() {
                vec4 col1 = neighbor(1.0,1.0);
                vec4 col2 = neighbor(-1.0, -1.0);
                vec4 col3 = neighbor(1.0, -1.0);
                vec4 col4 = neighbor(-1.0, 1.0);
                vec4 col5 = neighbor(0.0, 1.0);
                vec4 col6 = neighbor(0.0, -1.0);
                vec4 col7 = neighbor(1.0, 0.0);
                vec4 col8 = neighbor(-1.0, 0.0);

                vec4 average = 0.125*(col1 + col2 + col3 + col4 + col5 + col6 + col7 + col8);
                vec4 self = texture2D( tDiffuse, vUv);
                float alive = 0.0;

                if(average.y >= 0.25) {
                    if(average.y <= 0.3125) {
                        if(self.y >= 0.5) {
                           alive = 1.0;
                        }
                    } else {
                        if(average.y <= 0.4375) {
                            alive = 1.0;
                        }
                    }
                }

                // gl_FragColor = vec4(0, average.y, average.x, 1);
                gl_FragColor = vec4(0, alive, alive, 1);
            }

        </script>



        <script id="fragment_shader_pass_1" type="x-shader/x-fragment">
            varying vec2 vUv;
            uniform float time;

            float rand(vec2 co){
                return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
            }
            void main() {
                vec2 d = floor(20.0 * vUv);
                float t = floor(2.0 * time);
                float col = mod(d.x + d.y + t, 2.0);
                // gl_FragColor = vec4(col, col, col, 1.0);
                gl_FragColor = vec4(rand(vUv), rand(vUv), rand(vUv), 1.0);
            }
        </script>

        <script id="fragment_shader_copy" type="x-shader/x-fragment">
            varying vec2 vUv;
            uniform sampler2D tDiffuse;
            void main() {
                gl_FragColor = texture2D( tDiffuse, vUv );
            }
        </script>



        <script id="vertexShader" type="x-shader/x-vertex">
            varying vec2 vUv;
            void main() {
                vUv = uv;
                gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
            }
        </script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/102/three.js"></script>
<script src="main.js"></script>

</body>

</html>
